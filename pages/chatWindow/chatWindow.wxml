<!--pages/chatWindow/chatWindow.wxml-->
<!--对话框-->
<view class='cu-chat'>
<!--根据拿到的聊天记录呈现-->
<view wx:for="{{chatRecord}}" wx:for-index="index" wx:for-item="item"
      wx:key="*this"> 
      <!--这里的wx:key可以保证在刷新页面的时候不用重新刷新所有的item-->
<!--如果是自己发出的-->
 <view wx:if="{{item.sendID == sender && item.isLocation == 0}}">
  <view class="cu-item self">

    <view class="main">
      <view class="content bg-green shadow">
        <text>{{item.content}}</text>
      </view>
    </view>

    <view class="cu-avatar radius" style="background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);"></view>
    <view class="date">{{item.time}}</view>

  </view>
 </view>
 <!--如果是别人发出的-->
 <view wx:elif="{{item.isLocation == 0}}">
  <view class="cu-item">
    <view class="cu-avatar radius" style="background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big143004.jpg);"></view>
    <view class="main">
      <view class="content shadow">
        <text>{{item.content}}</text>
      </view>
    </view>
    <view class="date ">{{item.time}}</view>
  </view>
 </view>
 <!--如果是一条位置信息-->
 <view wx:else>
  <view class='cu-info' bindtap='showModal' data-target='Modal' data-content='{{item.content}}'>
  <view class="main">
    请点击查看位置信息
    <text>      发送人：{{item.sendID}}    </text>
    <text>{{item.time}}</text>
  </view>
  
  </view>

  <view class="cu-modal {{modalName=='Modal'?'show':''}}">
  <view class="cu-dialog">
    <view class="cu-bar bg-white justify-end">
      <view class="content">{{item.sendID}}の当前位置</view>
      <view class="action" bindtap="hideModal">
        <text class="cuIcon-close text-red"></text>
      </view>
    </view>
    <view class="padding-xl">
      <map class="map" id="map" longitude="{{longitude}}" latitude="{{latitude}}" scale="16" show-location="true"></map>
    </view>
  </view>
</view>
 </view>

</view>

</view>

<!--底栏发送-->
<view class="cu-bar foot input {{InputBottom!=0?'cur':''}}" style="bottom:{{InputBottom}}px">
  <view class="action">
    <text class="cuIcon-sound text-grey"></text>
  </view>
  <input class="solid-bottom" value="{{text}}" bindfocus="InputFocus" bindblur="InputBlur"  bindinput="InputSend" adjust-position="{{false}}" focus="{{false}}" maxlength="300" cursor-spacing="10"></input>
  <view class="action" bindtap='sendLocation'>
    <text class="cuIcon-locationfill text-grey"></text>
  </view>
  <button class="cu-btn bg-green shadow" bindtap="send">发送</button>
</view>

